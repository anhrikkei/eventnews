<div id="users" class="box box-primary">
    {% if ds_nguoidung %}
        <table id="tb" class="table table-striped table-hover">
            <thead>
                <th></th>
                <th>Tên đăng nhập</th>
                <th>Họ tên</th>
                <th>Email</th>
                <th>Ảnh đại diện</th>
                <th>Loại user</th>
                <th>Khóa tài khoản</th>
                <th></th>
            </thead>
            <tbody>
            {% for nguoidung in ds_nguoidung %}
                <tr>
                    <td>
                        {% if nguoidung.gender == 1 %}
                        <i class="fa fa-male"></i>
                        {% elif nguoidung.gender == 0 %}
                        <i class="fa fa-female"></i>
                        {% endif %}
                    </td>
                    <td>{{nguoidung.username}}</td>
                    <td>{{nguoidung.fullname}}</td>
                    <td>{{nguoidung.email}}</td>

                    <td>
                        <img height="25" style="float:left; margin:auto" class="img-circle" src="/media/{{nguoidung.avatar_url}}" alt="">
                    </td>
                    <td>{{nguoidung.group.name}}</td>
                    <td>
                        <div class="form-group" style="background-color: gray; max-width: 70px">
                            {% if nguoidung.group_id == 1 %}
                                <button style="background-color: gray; color:white" class="btn btn-sm btn-success">
                                    <i class="fa fa-exchange"></i>
                                </button>
                            {% else %}
                                <a href="../nguoidung_trangthai/{{nguoidung.username}}">
                                    <button style="background-color: #00a98f; color:white" class="btn btn-sm btn-success">
                                        <i class="fa fa-exchange"></i>
                                    </button>
                                </a>
                            {% endif %}
                            <small name="btnmenu" class="" style="color:white">
                                <i>{{nguoidung.is_locked}}</i>
                            </small>
                        </div>
                    </td>
                    <td>
                        {% if nguoidung.group_id == 1 %}
                            <button class="btn-link">
                                <i class="glyphicon glyphicon-trash" onclick="tbxoa()"></i>
                            </button>
                            <script>
                                function tbxoa(){
                                    alert('Không thể xóa tài khoản này');
                                }
                            </script>
                        {% elif nguoidung.group_id == 2 %}
                        <button id="{{nguoidung.username}}" class="btn-link">
                            <i style="color: #00a98f" class="glyphicon glyphicon-trash"></i>
                        </button>
                        <script>
                            $("#{{nguoidung.username}}").click(function(){
                                if(confirm('Xóa người dùng {{nguoidung.username}} sẽ mất các bài viết trong danh mục?')==true){
                                    window.location='../nguoidung_xoa/{{nguoidung.username}}';
                                    }
                                else{
                                    return false;
                                }
                            })
                        </script>
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
        <!--phân trang-->
        <div id="pagination" class="pull-right">
            <ul class="pagination pagination-sm">
                <span class="step-links">
                    {% if ds_nguoidung.has_previous %}
                        <a class="page-links" href="?page=1&search={{search}}" data-search="{{search}}" data-page="1">
                            <i class="glyphicon glyphicon-backward"></i>
                        </a>
                    {% endif %}
                </span>
                <span class="step-links">
                    {% if ds_nguoidung.has_previous %}
                        <a class="page-links" href="?page={{ ds_nguoidung.previous_page_number }}&search={{search}}" data-search="{{search}}" data-page="{{ ds_nguoidung.previous_page_number }}">
                            <i class="glyphicon glyphicon-chevron-left"></i>
                        </a>
                    {% endif %}
                </span>
                <span class="current">
                    Trang {{ ds_nguoidung.number }} / {{ ds_nguoidung.paginator.num_pages }}
                </span>
                <span>
                    {% if ds_nguoidung.has_next %}
                        <a class="page-links" href="?page={{ ds_nguoidung.next_page_number }}&search={{search}}" data-search="{{search}}" data-page="{{ ds_nguoidung.next_page_number }}"><i class="glyphicon glyphicon-chevron-right"></i></a>
                    {% endif %}
                </span>
                <span>
                    {% if ds_nguoidung.has_next %}
                        <a class="page-links" href="?page={{ ds_nguoidung.paginator.num_pages }}&search={{search}}" data-search="{{search}}" data-page="{{ ds_nguoidung.paginator.num_pages }}"><i class="glyphicon glyphicon-forward"></i></a>
                    {% endif %}
                </span>
            </ul>
        </div>
        <!--//phân trang-->
    {% else %}
        <center> không có dữ liệu thỏa mãn...</center>
    {% endif %}
    <script>
    $(document).ready(function(){
        $("#users #pagination a.page-links").click(function(event){
            event.preventDefault();
            $.ajax({
                type: 'GET',
                url: '../nguoidung_ajaxsearch/',
                data:{
                    'search': $(this).data('search'),
                    'page': $(this).data('page'),
                },
                success: function(data){
                    $("#users").replaceWith(data);
                }
            });
        });
    });
    </script>
</div>
